external_network_interface = "ens3"

[initialization.v4]
filter = [
    "-P INPUT ACCEPT",
    "-F INPUT",
    "-A INPUT -i docker0 -j ACCEPT",
]

[initialization.v6]
filter = [
    "-P INPUT ACCEPT",
    "-F INPUT",
    "-A INPUT -i docker0 -j ACCEPT",
]

[container_to_container]
default_policy = "DROP"

[[container_to_container.rules]]
network = "dfwrs_proxy"
src_container = "dfwrs_proxy_1"
action = "ACCEPT"

[[container_to_container.rules]]
network = "dfwrs_a"
src_container = "dfwrs_a_1"
dst_container = "dfwrs_b_1"
action = "ACCEPT"

[[container_to_container.rules]]
network = "dfwrs_b"
action = "ACCEPT"

[container_to_wider_world]
default_policy = "ACCEPT"

[[container_to_wider_world.rules]]
network = "dfwrs_proxy"
filter = "-p tcp"
action = "ACCEPT"
external_network_interface = "ens3"

[container_to_host]
default_policy = "ACCEPT"

[[container_to_host.rules]]
network = "some"
src_container = "cont"
filter = "filter"
action = "OTHER"

[[container_to_host.rules]]
network = "some"
# OPTIONAL src_container = "cont"
# OPTIONAL filter = "filter"
action = "OTHER"

[wider_world_to_container]

[[wider_world_to_container.rules]]
network = "network"
dst_container = "dst_container"
expose_port = 1
external_network_interface = ["someif"]

[[wider_world_to_container.rules]]
network = "network"
dst_container = "dst_container"
expose_port = "2"
external_network_interface = ["someif"]

[[wider_world_to_container.rules]]
network = "network"
dst_container = "dst_container"
expose_port = "3/tcp"
# OPTIONAL external_network_interface = ["someif"]

[[wider_world_to_container.rules]]
network = "network"
dst_container = "dst_container"
expose_port = { host_port = 4, container_port = 101, family = "tcp" }

[[wider_world_to_container.rules]]
network = "network"
dst_container = "dst_container"
expose_port = { host_port = 5, family = "tcp" }

[[wider_world_to_container.rules]]
network = "network"
dst_container = "dst_container"
expose_port = { host_port = 6, container_port = 102 }

[container_dnat]

[[container_dnat.rules]]
src_network = "network"
src_container = "container"
dst_network = "network"
dst_container = "container"
expose_port = "80/tcp"

[[container_dnat.rules]]
#src_network = "network"
#src_container = "container"
dst_network = "network"
dst_container = "container"
expose_port = "80/tcp"

